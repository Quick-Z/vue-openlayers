(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e693b48"],{"7c7a":function(e){e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[149.042007,-35.349998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-71.660004,-35.423]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[174.315994,-35.721001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-64.288002,-36.627998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-73.055,-36.826]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[174.761002,-36.903999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[176.154999,-37.700001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[175.272995,-37.776001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[145.075104,-37.852959]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[178.016006,-38.659]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-62.274067,-38.725273]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-72.575996,-38.729]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-68.283333,-38.944908]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[174.078003,-39.07]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[176.841003,-39.639999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[175.035004,-39.93]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-62.995026,-40.815025]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[173.248001,-41.297001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-72.952003,-41.474998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[171.207001,-42.472]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[147.291,-42.851002]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-65.099998,-43.299999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[172.638,-43.523998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-72.702003,-45.402]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-67.5,-45.830002]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[170.473999,-45.883999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[168.373001,-46.412998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-69.228996,-51.625]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-57.848999,-51.701]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-70.934654,-53.166161]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-68.297997,-54.792]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[129.054993,35.158001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[23.331871,42.707264]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-15.598,11.864]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[147.147949,-9.497187]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-74.080513,4.63022]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[12.55,55.720001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[103.831787,1.268858]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[126.935249,37.542351]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[16.320986,48.202118]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-58.449841,-34.622501]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[4.368,50.837002]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[96.82608,-12.157536]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-2.973783,43.282158]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[126.907997,35.153]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[128.591003,35.863998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[100.310997,5.364]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[165.5,-21.5]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[166.916702,-0.5167]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[51.448002,35.773998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[49.700001,34.083332]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-5.3167,35.883301]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[130.933304,33.950001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[136.761993,35.41]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[77.216751,28.568726]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[35.22522,31.773746]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[17.934,62.633999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[15.638,58.402]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[14.178,57.785999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[44.233002,46.266998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[90.374001,22.702999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[159.983002,59.083]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[114.532997,51.167]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[104.699997,52.833]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[100.282997,64.333]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[86.217003,69.449997]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[69,61.016998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[54.667,59.016998]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[53.033001,67.616997]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[44.783001,43.233002]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[132.899994,48.817001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[34.333,61.783001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[32,63]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[23.708,70.677002]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-53.553001,69.244003]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-133.705994,68.365997]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[64.040001,67.504997]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-21.895,64.135002]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-149.897995,61.202999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-66.810997,54.800999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-130.309998,54.320999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-2.971,53.423]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[22.311001,48.622002]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[100.123001,46.692001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-66.068001,45.264]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[38.960999,45.036999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[34.104,44.962002]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[42.063,44.282001]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[71.371002,42.889]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[109.807999,40.659]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[23.653,37.944]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[39.173,21.542999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-96.123001,19.184999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[42.507999,18.219999]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-15.978,18.084]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[74.843002,12.869]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-10.797,6.301]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[7.068,6.215]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[9.454,0.391]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[15.299,-4.321]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[34.743999,-4.817]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-77.044998,-12.082]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-57.283001,-25.406]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-71.332001,-29.959]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[46.659145,61.259964]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[174.80722,-41.334835]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[86.599289,67.493851]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[177.480255,64.755272]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[17.991455,59.331165]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[76.280418,9.970155]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-60.281559,53.29509]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-2.674783,42.850159]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[-68.541466,63.755356]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[51.141739,43.690456]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[20.412556,44.799683]}},{"type":"Feature","properties":{},"geometry":{"type":"Point","coordinates":[19.4,42.5]}}]}')},cfee:function(e,t,r){"use strict";r.r(t);var o,i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"vm"},[r("h2",{staticClass:"h-title"},[e._v("热力图 Heatmap")]),r("label",[e._v("半径大小")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.radius,expression:"radius"}],attrs:{id:"radius",type:"range",min:"1",max:"50",step:"1"},domProps:{value:e.radius},on:{change:e.changeRadius,__r:function(t){e.radius=t.target.value}}}),r("label",[e._v("模糊半径")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.blur,expression:"blur"}],attrs:{id:"blur",type:"range",min:"1",max:"50",step:"1"},domProps:{value:e.blur},on:{change:e.changeBlur,__r:function(t){e.blur=t.target.value}}}),r("button",{on:{click:e.getHeatName}},[e._v("输出涂层名")]),r("div",{ref:"map",staticClass:"map-x",attrs:{id:"map"}})])},n=[],a=(r("d81d"),r("5bc0"),r("5eee")),s=r("a2c7"),u=r("3e6b"),p=r("ae50"),c=r("f623"),f=r("a43f"),h=r("496f"),d=34962,y=34963,l=35040,_=35044,g=35048,m=5121,v=5123,E=5125,T=5126,b=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function F(e,t){for(var r=b.length,o=0;o<r;++o)try{var i=e.getContext(b[o],t);if(i)return i}catch(n){}return null}function P(){if(!o){var e=document.createElement("canvas"),t=F(e);t&&(o=t.getSupportedExtensions())}return o}var R=r("92fa"),x={STATIC_DRAW:_,STREAM_DRAW:l,DYNAMIC_DRAW:g},A=function(){function e(e,t){this.array=null,this.type=e,Object(R["a"])(e===d||e===y,62),this.usage=void 0!==t?t:x.STATIC_DRAW}return e.prototype.ofSize=function(e){this.array=new(S(this.type))(e)},e.prototype.fromArray=function(e){this.array=S(this.type).from(e)},e.prototype.fromArrayBuffer=function(e){this.array=new(S(this.type))(e)},e.prototype.getType=function(){return this.type},e.prototype.getArray=function(){return this.array},e.prototype.getUsage=function(){return this.usage},e.prototype.getSize=function(){return this.array?this.array.length:0},e}();function S(e){switch(e){case d:return Float32Array;case y:return Uint32Array;default:return Float32Array}}var L=A,C=r("faf4"),w=r("3333"),O=r("070d"),U={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},D=r("da5c"),I="\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n",B="\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n",G=function(){function e(e){this.gl_=e.webGlContext;var t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();var r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||I),t.compileShader(r);var o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(o,e.fragmentShader||B),t.compileShader(o),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,o),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();var i=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(r){this.uniforms_.push({value:e.uniforms[r],location:t.getUniformLocation(this.renderTargetProgram_,r)})}.bind(this))}return e.prototype.getGL=function(){return this.gl_},e.prototype.init=function(e){var t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;var o=0,i=t.RGBA,n=0,a=t.RGBA,s=t.UNSIGNED_BYTE,u=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,o,i,r[0],r[1],n,a,s,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},e.prototype.apply=function(e,t){var r=this.getGL(),o=e.size;r.bindFramebuffer(r.FRAMEBUFFER,t?t.getFrameBuffer():null),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.useProgram(this.renderTargetProgram_),r.enableVertexAttribArray(this.renderTargetAttribLocation_),r.vertexAttribPointer(this.renderTargetAttribLocation_,2,r.FLOAT,!1,0,0),r.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),r.uniform1i(this.renderTargetTextureLocation_,0),this.applyUniforms(e),r.drawArrays(r.TRIANGLES,0,6)},e.prototype.getFrameBuffer=function(){return this.frameBuffer_},e.prototype.applyUniforms=function(e){var t,r=this.getGL(),o=1;this.uniforms_.forEach((function(i){if(t="function"===typeof i.value?i.value(e):i.value,t instanceof HTMLCanvasElement||t instanceof ImageData)i.texture||(i.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+o]),r.bindTexture(r.TEXTURE_2D,i.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),t instanceof ImageData?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,t.width,t.height,0,r.UNSIGNED_BYTE,new Uint8Array(t.data)):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),r.uniform1i(i.location,o++);else if(Array.isArray(t))switch(t.length){case 2:return void r.uniform2f(i.location,t[0],t[1]);case 3:return void r.uniform3f(i.location,t[0],t[1],t[2]);case 4:return void r.uniform4f(i.location,t[0],t[1],t[2],t[3]);default:return}else"number"===typeof t&&r.uniform1f(i.location,t)}))},e}(),N=G,M=r("38f3"),j=r("a896");function z(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function X(e,t){return e[0]=t[0],e[1]=t[1],e[4]=t[2],e[5]=t[3],e[12]=t[4],e[13]=t[5],e}var H=r("1300"),V=r("9f5e"),W=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),k={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},Y={UNSIGNED_BYTE:m,UNSIGNED_SHORT:v,UNSIGNED_INT:E,FLOAT:T},q=function(e){function t(t){var r=e.call(this)||this,o=t||{};r.boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind(r),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind(r),r.canvas_=document.createElement("canvas"),r.canvas_.style.position="absolute",r.canvas_.style.left="0",r.gl_=F(r.canvas_);var i=r.getGL();if(r.bufferCache_={},r.currentProgram_=null,Object(R["a"])(Object(V["d"])(P(),"OES_element_index_uint"),63),i.getExtension("OES_element_index_uint"),r.canvas_.addEventListener(U.LOST,r.boundHandleWebGLContextLost_),r.canvas_.addEventListener(U.RESTORED,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=Object(j["c"])(),r.offsetScaleMatrix_=Object(j["c"])(),r.tmpMat4_=z(),r.uniformLocations_={},r.attribLocations_={},r.uniforms_=[],o.uniforms)for(var n in o.uniforms)r.uniforms_.push({name:n,value:o.uniforms[n]});return r.postProcessPasses_=o.postProcesses?o.postProcesses.map((function(e){return new N({webGlContext:i,scaleRatio:e.scaleRatio,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms})})):[new N({webGlContext:i})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return W(t,e),t.prototype.bindBuffer=function(e){var t=this.getGL(),r=Object(H["c"])(e),o=this.bufferCache_[r];if(!o){var i=t.createBuffer();o={buffer:e,webGlBuffer:i},this.bufferCache_[r]=o}t.bindBuffer(e.getType(),o.webGlBuffer)},t.prototype.flushBufferData=function(e){var t=this.getGL();this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())},t.prototype.deleteBuffer=function(e){var t=this.getGL(),r=Object(H["c"])(e),o=this.bufferCache_[r];o&&!t.isContextLost()&&t.deleteBuffer(o.webGlBuffer),delete this.bufferCache_[r]},t.prototype.disposeInternal=function(){this.canvas_.removeEventListener(U.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(U.RESTORED,this.boundHandleWebGLContextRestored_)},t.prototype.prepareDraw=function(e,t){var r=this.getGL(),o=this.getCanvas(),i=e.size,n=e.pixelRatio;o.width=i[0]*n,o.height=i[1]*n,o.style.width=i[0]+"px",o.style.height=i[1]+"px",r.useProgram(this.currentProgram_);for(var a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(e);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,t?r.ZERO:r.ONE_MINUS_SRC_ALPHA),r.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},t.prototype.prepareDrawToRenderTarget=function(e,t,r){var o=this.getGL(),i=t.getSize();o.bindFramebuffer(o.FRAMEBUFFER,t.getFramebuffer()),o.viewport(0,0,i[0],i[1]),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.enable(o.BLEND),o.blendFunc(o.ONE,r?o.ZERO:o.ONE_MINUS_SRC_ALPHA),o.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},t.prototype.drawElements=function(e,t){var r=this.getGL(),o=r.UNSIGNED_INT,i=4,n=t-e,a=e*i;r.drawElements(r.TRIANGLES,n,o,a)},t.prototype.finalizeDraw=function(e){for(var t=0;t<this.postProcessPasses_.length;t++)this.postProcessPasses_[t].apply(e,this.postProcessPasses_[t+1]||null)},t.prototype.getCanvas=function(){return this.canvas_},t.prototype.getGL=function(){return this.gl_},t.prototype.applyFrameState=function(e){var t=e.size,r=e.viewState.rotation,o=Object(j["g"])(this.offsetScaleMatrix_);Object(j["i"])(o,2/t[0],2/t[1]);var i=Object(j["g"])(this.offsetRotateMatrix_);0!==r&&Object(j["h"])(i,-r),this.setUniformMatrixValue(k.OFFSET_SCALE_MATRIX,X(this.tmpMat4_,o)),this.setUniformMatrixValue(k.OFFSET_ROTATION_MATRIX,X(this.tmpMat4_,i)),this.setUniformFloatValue(k.TIME,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(k.ZOOM,e.viewState.zoom),this.setUniformFloatValue(k.RESOLUTION,e.viewState.resolution)},t.prototype.applyUniforms=function(e){var t,r=this.getGL(),o=0;this.uniforms_.forEach(function(i){if(t="function"===typeof i.value?i.value(e):i.value,t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof ImageData){i.texture||(i.prevValue=void 0,i.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+o]),r.bindTexture(r.TEXTURE_2D,i.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);var n=!(t instanceof HTMLImageElement)||t.complete;n&&i.prevValue!==t&&(i.prevValue=t,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)),r.uniform1i(this.getUniformLocation(i.name),o++)}else if(Array.isArray(t)&&6===t.length)this.setUniformMatrixValue(i.name,X(this.tmpMat4_,t));else if(Array.isArray(t)&&t.length<=4)switch(t.length){case 2:return void r.uniform2f(this.getUniformLocation(i.name),t[0],t[1]);case 3:return void r.uniform3f(this.getUniformLocation(i.name),t[0],t[1],t[2]);case 4:return void r.uniform4f(this.getUniformLocation(i.name),t[0],t[1],t[2],t[3]);default:return}else"number"===typeof t&&r.uniform1f(this.getUniformLocation(i.name),t)}.bind(this))},t.prototype.useProgram=function(e){if(e==this.currentProgram_)return!1;var t=this.getGL();return t.useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},!0},t.prototype.compileShader=function(e,t){var r=this.getGL(),o=r.createShader(t);return r.shaderSource(o,e),r.compileShader(o),o},t.prototype.getProgram=function(e,t){var r=this.getGL(),o=this.compileShader(e,r.FRAGMENT_SHADER),i=this.compileShader(t,r.VERTEX_SHADER),n=r.createProgram();if(r.attachShader(n,o),r.attachShader(n,i),r.linkProgram(n),!r.getShaderParameter(o,r.COMPILE_STATUS)){var a="Fragment shader compliation failed: "+r.getShaderInfoLog(o);throw new Error(a)}if(r.deleteShader(o),!r.getShaderParameter(i,r.COMPILE_STATUS)){a="Vertex shader compilation failed: "+r.getShaderInfoLog(i);throw new Error(a)}if(r.deleteShader(i),!r.getProgramParameter(n,r.LINK_STATUS)){a="GL program linking failed: "+r.getShaderInfoLog(i);throw new Error(a)}return n},t.prototype.getUniformLocation=function(e){return void 0===this.uniformLocations_[e]&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]},t.prototype.getAttributeLocation=function(e){return void 0===this.attribLocations_[e]&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]},t.prototype.makeProjectionTransform=function(e,t){var r=e.size,o=e.viewState.rotation,i=e.viewState.resolution,n=e.viewState.center;return Object(j["g"])(t),Object(j["b"])(t,0,0,2/(i*r[0]),2/(i*r[1]),-o,-n[0],-n[1]),t},t.prototype.setUniformFloatValue=function(e,t){this.getGL().uniform1f(this.getUniformLocation(e),t)},t.prototype.setUniformMatrixValue=function(e,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(e),!1,t)},t.prototype.enableAttributeArray_=function(e,t,r,o,i){var n=this.getAttributeLocation(e);n<0||(this.getGL().enableVertexAttribArray(n),this.getGL().vertexAttribPointer(n,t,r,!1,o,i))},t.prototype.enableAttributes=function(e){for(var t=Z(e),r=0,o=0;o<e.length;o++){var i=e[o];this.enableAttributeArray_(i.name,i.size,i.type||T,t,r),r+=i.size*J(i.type)}},t.prototype.handleWebGLContextLost=function(){Object(M["b"])(this.bufferCache_),this.currentProgram_=null},t.prototype.handleWebGLContextRestored=function(){},t.prototype.createTexture=function(e,t,r){var o=this.getGL(),i=r||o.createTexture(),n=0,a=o.RGBA,s=0,u=o.RGBA,p=o.UNSIGNED_BYTE;return o.bindTexture(o.TEXTURE_2D,i),t?o.texImage2D(o.TEXTURE_2D,n,a,u,p,t):o.texImage2D(o.TEXTURE_2D,n,a,e[0],e[1],s,u,p,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),i},t}(D["a"]);function Z(e){for(var t=0,r=0;r<e.length;r++){var o=e[r];t+=o.size*J(o.type)}return t}function J(e){switch(e){case Y.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Y.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Y.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Y.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var K=q,$=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Q={GENERATE_BUFFERS:"GENERATE_BUFFERS"},ee=function(e){function t(t,r){var o=e.call(this,t)||this,i=r||{};return o.helper=new K({postProcesses:i.postProcesses,uniforms:i.uniforms}),void 0!==i.className&&(o.helper.getCanvas().className=i.className),o}return $(t,e),t.prototype.disposeInternal=function(){this.helper.dispose(),e.prototype.disposeInternal.call(this)},t.prototype.dispatchRenderEvent_=function(e,t){var r=this.getLayer();if(r.hasListener(e)){var o=new w["a"](e,null,t,null);r.dispatchEvent(o)}},t.prototype.preRender=function(e){this.dispatchRenderEvent_(O["a"].PRERENDER,e)},t.prototype.postRender=function(e){this.dispatchRenderEvent_(O["a"].POSTRENDER,e)},t}(C["a"]);function te(e,t){var r=t||[],o=256,i=o-1;return r[0]=Math.floor(e/o/o/o)/i,r[1]=Math.floor(e/o/o)%o/i,r[2]=Math.floor(e/o)%o/i,r[3]=e%o/i,r}function re(e){var t=0,r=256,o=r-1;return t+=Math.round(e[0]*r*r*r*o),t+=Math.round(e[1]*r*r*o),t+=Math.round(e[2]*r*o),t+=Math.round(e[3]*o),t}var oe=ee,ie=new Uint8Array(4),ne=function(){function e(e,t){this.helper_=e;var r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return e.prototype.setSize=function(e){Object(V["b"])(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())},e.prototype.getSize=function(){return this.size_},e.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},e.prototype.readAll=function(){if(this.dataCacheDirty_){var e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},e.prototype.readPixel=function(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return ie[0]=0,ie[1]=0,ie[2]=0,ie[3]=0,ie;this.readAll();var r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return ie[0]=this.data_[4*r],ie[1]=this.data_[4*r+1],ie[2]=this.data_[4*r+2],ie[3]=this.data_[4*r+3],ie},e.prototype.getTexture=function(){return this.texture_},e.prototype.getFramebuffer=function(){return this.framebuffer_},e.prototype.updateSize_=function(){var e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(e[0]*e[1]*4)},e}(),ae=ne,se=r("0af5"),ue='var e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n="GENERATE_BUFFERS",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};',pe=new Blob([ue],{type:"application/javascript"}),ce=URL.createObjectURL(pe);function fe(){return new Worker(ce)}var he=r("1e8d"),de=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),ye=function(e){function t(t,r){var o=this,i=r.uniforms||{},n=Object(j["c"])();i[k.PROJECTION_MATRIX]=n,o=e.call(this,t,{className:r.className,uniforms:i,postProcesses:r.postProcesses})||this,o.sourceRevision_=-1,o.verticesBuffer_=new L(d,g),o.hitVerticesBuffer_=new L(d,g),o.indicesBuffer_=new L(y,g),o.program_=o.helper.getProgram(r.fragmentShader,r.vertexShader),o.hitDetectionEnabled_=!(!r.hitFragmentShader||!r.hitVertexShader),o.hitProgram_=o.hitDetectionEnabled_&&o.helper.getProgram(r.hitFragmentShader,r.hitVertexShader);var a=r.attributes?r.attributes.map((function(e){return{name:"a_"+e.name,size:1,type:Y.FLOAT}})):[];o.attributes=[{name:"a_position",size:2,type:Y.FLOAT},{name:"a_index",size:1,type:Y.FLOAT}].concat(a),o.hitDetectionAttributes=[{name:"a_position",size:2,type:Y.FLOAT},{name:"a_index",size:1,type:Y.FLOAT},{name:"a_hitColor",size:4,type:Y.FLOAT},{name:"a_featureUid",size:1,type:Y.FLOAT}].concat(a),o.customAttributes=r.attributes?r.attributes:[],o.previousExtent_=Object(se["k"])(),o.currentTransform_=n,o.renderTransform_=Object(j["c"])(),o.invertRenderTransform_=Object(j["c"])(),o.renderInstructions_=new Float32Array(0),o.hitRenderInstructions_=new Float32Array(0),o.hitRenderTarget_=o.hitDetectionEnabled_&&new ae(o.helper),o.worker_=fe(),o.worker_.addEventListener("message",function(e){var t=e.data;if(t.type===Q.GENERATE_BUFFERS){var r=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,Object(j["d"])(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):this.renderInstructions_=new Float32Array(e.data.renderInstructions),this.getLayer().changed()}}.bind(o)),o.featureCache_={},o.featureCount_=0;var s=o.getLayer().getSource();return o.sourceListenKeys_=[Object(he["a"])(s,f["a"].ADDFEATURE,o.handleSourceFeatureAdded_,o),Object(he["a"])(s,f["a"].CHANGEFEATURE,o.handleSourceFeatureChanged_,o),Object(he["a"])(s,f["a"].REMOVEFEATURE,o.handleSourceFeatureDelete_,o),Object(he["a"])(s,f["a"].CLEAR,o.handleSourceFeatureClear_,o)],s.forEachFeature(function(e){this.featureCache_[Object(H["c"])(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(o)),o}return de(t,e),t.prototype.handleSourceFeatureAdded_=function(e){var t=e.feature;this.featureCache_[Object(H["c"])(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(e){var t=e.feature;this.featureCache_[Object(H["c"])(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(e){var t=e.feature;delete this.featureCache_[Object(H["c"])(t)],this.featureCount_--},t.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},t.prototype.renderFrame=function(e){this.preRender(e);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t),this.helper.finalizeDraw(e);var r=this.helper.getCanvas(),o=e.layerStatesArray[e.layerIndex],i=o.opacity;return i!==parseFloat(r.style.opacity)&&(r.style.opacity=String(i)),this.hitDetectionEnabled_&&(this.renderHitDetection(e),this.hitRenderTarget_.clearCachedData()),this.postRender(e),r},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource(),o=e.viewState,i=!e.viewHints[h["a"].ANIMATING]&&!e.viewHints[h["a"].INTERACTING],n=!Object(se["p"])(this.previousExtent_,e.extent),a=this.sourceRevision_<r.getRevision();if(a&&(this.sourceRevision_=r.getRevision()),i&&(n||a)){var s=o.projection,u=o.resolution,c=t instanceof p["a"]?t.getRenderBuffer():0,f=Object(se["d"])(e.extent,c*u);r.loadFeatures(f,u,s),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.makeProjectionTransform(e,this.currentTransform_),Object(j["f"])(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(e){var t=Object(j["c"])();this.helper.makeProjectionTransform(e,t);var r,o,i=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===i||(this.renderInstructions_=new Float32Array(i)),this.hitDetectionEnabled_){var n=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===n||(this.hitRenderInstructions_=new Float32Array(n))}var a,s=[],u=[],p=0,f=0;for(var h in this.featureCache_)if(r=this.featureCache_[h],o=r.geometry,o&&o.getType()===c["a"].POINT){s[0]=o.getFlatCoordinates()[0],s[1]=o.getFlatCoordinates()[1],Object(j["a"])(t,s),a=te(f+6,u),this.renderInstructions_[p++]=s[0],this.renderInstructions_[p++]=s[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[f++]=s[0],this.hitRenderInstructions_[f++]=s[1],this.hitRenderInstructions_[f++]=a[0],this.hitRenderInstructions_[f++]=a[1],this.hitRenderInstructions_[f++]=a[2],this.hitRenderInstructions_[f++]=a[3],this.hitRenderInstructions_[f++]=Number(h));for(var d=void 0,y=0;y<this.customAttributes.length;y++)d=this.customAttributes[y].callback(r.feature,r.properties),this.renderInstructions_[p++]=d,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[f++]=d)}var l={type:Q.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(l["projectionTransform"]=t,this.worker_.postMessage(l,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var _={type:Q.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};_["projectionTransform"]=t,_["hitDetection"]=!0,this.worker_.postMessage(_,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,o,i){if(Object(R["a"])(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var n=Object(j["a"])(t.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(n[0]/2,n[1]/2),s=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],u=re(s),p=this.hitRenderInstructions_[u],c=Math.floor(p).toString(),f=this.getLayer().getSource(),h=f.getFeatureByUid(c);return h?o(h,this.getLayer(),null):void 0}},t.prototype.renderHitDetection=function(e){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}},t.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach((function(e){Object(he["c"])(e)})),this.sourceListenKeys_=null,e.prototype.disposeInternal.call(this)},t}(oe),le=ye,_e=r("7fc9"),ge=r("0999"),me=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),ve={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},Ee=["#00f","#0ff","#0f0","#ff0","#f00"],Te=function(e){function t(t){var r=this,o=t||{},i=Object(M["a"])({},o);delete i.gradient,delete i.radius,delete i.blur,delete i.weight,r=e.call(this,i)||this,r.gradient_=null,r.addChangeListener(ve.GRADIENT,r.handleGradientChanged_),r.setGradient(o.gradient?o.gradient:Ee),r.setBlur(void 0!==o.blur?o.blur:15),r.setRadius(void 0!==o.radius?o.radius:8);var n=o.weight?o.weight:"weight";return r.weightFunction_="string"===typeof n?function(e){return e.get(n)}:n,r.setRenderOrder(null),r}return me(t,e),t.prototype.getBlur=function(){return this.get(ve.BLUR)},t.prototype.getGradient=function(){return this.get(ve.GRADIENT)},t.prototype.getRadius=function(){return this.get(ve.RADIUS)},t.prototype.handleGradientChanged_=function(){this.gradient_=be(this.getGradient())},t.prototype.setBlur=function(e){this.set(ve.BLUR,e)},t.prototype.setGradient=function(e){this.set(ve.GRADIENT,e)},t.prototype.setRadius=function(e){this.set(ve.RADIUS,e)},t.prototype.createRenderer=function(){return new le(this,{className:this.getClassName(),attributes:[{name:"weight",callback:function(e){var t=this.weightFunction_(e);return void 0!==t?Object(_e["a"])(t,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(ve.RADIUS)+this.get(ve.BLUR))}.bind(this),u_blurSlope:function(){return this.get(ve.RADIUS)/Math.max(1,this.get(ve.BLUR))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this)}}]})},t.prototype.renderDeclutter=function(){},t}(u["a"]);function be(e){for(var t=1,r=256,o=Object(ge["a"])(t,r),i=o.createLinearGradient(0,0,t,r),n=1/(e.length-1),a=0,s=e.length;a<s;++a)i.addColorStop(a*n,e[a]);return o.fillStyle=i,o.fillRect(0,0,t,r),o.canvas}var Fe=Te,Pe=r("480c"),Re=r("5831"),xe=r("2ef1"),Ae=r("d0e9"),Se=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Le=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',Ae["a"]],Ce={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},we={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},Oe=function(e){function t(t){var r=this,o=t.layer.indexOf("-"),i=-1==o?t.layer:t.layer.slice(0,o),n=we[i],a=Ce[t.layer],s=void 0!==t.url?t.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+t.layer+"/{z}/{x}/{y}."+a.extension;return r=e.call(this,{attributions:Le,cacheSize:t.cacheSize,crossOrigin:"anonymous",imageSmoothing:t.imageSmoothing,maxZoom:void 0!=t.maxZoom?t.maxZoom:n.maxZoom,minZoom:void 0!=t.minZoom?t.minZoom:n.minZoom,opaque:a.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:s,wrapX:t.wrapX,zDirection:t.zDirection})||this,r}return Se(t,e),t}(xe["a"]),Ue=Oe,De=r("7c7a"),Ie=r("a2e1"),Be={data:function(){return{map:null,radius:5,blur:15,vector:new Fe({name:"热力热力",source:new Re["a"]({features:(new Ie["a"]).readFeatures(De,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"})}),radius:10,blur:10,gradient:["#00f","#0ff","#0f0","#ff0","#f00"]})}},methods:{initMap:function(){var e=new Pe["a"]({source:new Ue({layer:"toner"})});this.map=new a["a"]({target:this.$refs.map,layers:[e,this.vector],view:new s["a"]({center:[20.042007,-35.349998],zoom:19})})},changeRadius:function(){this.vector.setRadius(parseInt(this.radius,10))},changeBlur:function(){this.vector.setBlur(parseInt(this.blur,10))},getHeatName:function(){for(var e=this.map.getLayers(),t=0;t<e.getLength();t++)console.log("图层名：",e.item(t).get("name"))}},mounted:function(){this.initMap()}},Ge=Be,Ne=r("2877"),Me=Object(Ne["a"])(Ge,i,n,!1,null,"21bb09b7",null);t["default"]=Me.exports}}]);
//# sourceMappingURL=chunk-2e693b48.0d000a22.js.map